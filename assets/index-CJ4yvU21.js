(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const f of a.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&c(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();const y=t=>`https://pokeapi.co/api/v2/pokemon/${t}`,P=t=>`https://pokeapi.co/api/v2/type/${t}`,w=1025;let s=null,i=null;const o=t=>document.querySelector(t),u=t=>new Promise(e=>setTimeout(e,t)),m=()=>Math.floor(Math.random()*w)+1;function p(t,e,n=0){return t.stats?.find(r=>r.stat?.name===e)?.base_stat??n}function b(t){return{id:t.id,name:t.name,frontSprite:t.sprites?.front_default??"",backSprite:t.sprites?.back_default??"",hp:p(t,"hp",0),attack:p(t,"attack",0),typeName:t.types?.[0]?.type?.name??"unknown"}}async function h(t){const e=await fetch(y(t));if(!e.ok)throw new Error(`Failed to fetch pokemon ${t}`);const n=await e.json();return b(n)}function x(){const t=o("#vs-title"),e=s?.name??"_",n=i?.name??"_";t.innerText=`${e} vs ${n}`}function g(t,e){o("#name-"+t).textContent=e?.name??"_",o("#hp-"+t).textContent=e?.hp??"_",o("#atk-"+t).textContent=e?.attack??"_";const n=o("#img-"+t);n.src=e?.frontSprite??"",n.alt=e?.name??"",n.onmouseenter=()=>{e?.backSprite&&(n.src=e.backSprite)},n.onmouseleave=()=>{e?.frontSprite&&(n.src=e.frontSprite)}}function C(){o("#result").textContent="",o("#winner-type").textContent="",o("#same-grid").innerHTML="",o("#same-type").hidden=!0}async function k(){C(),o("#btn-battle").disabled=!0;let t=m(),e=m();for(;t===e;)e=m();try{const[n,c]=await Promise.all([h(t),h(e)]);s=n,i=c,g(1,s),g(2,i),x(),o("#btn-battle").disabled=!(s&&i)}catch(n){console.error(n),o("#result").textContent="Error fetching pokemon"}}async function S(){if(!s||!i)return;const t=o("#btn-battle"),e="Battle";t.disabled=!0,t.textContent="calculating...",await u(1e3),t.textContent="fighting.",await u(1e3),t.textContent="fighting..",await u(1e3),t.textContent="fighting...",await u(1e3),t.textContent=e,t.disabled=!1,v()}function v(){if(!s||!i)return;const t=o("#result");if(s.attack===i.attack){t.textContent=`It's a tie! (${s.name} ${s.attack} = ${i.name} ${i.attack})`;return}const e=s.attack>i.attack?s:i,c=o(`#img-${e===s?1:2}`);E(c),t.textContent=`The Winner is: ${e.name}!`,o("#winner-type").textContent=`Type: ${e.typeName}`,I(e).catch(console.error)}function E(t){t.classList.remove("flash-once"),t.offsetWidth,t.classList.add("flash-once"),t.addEventListener("animationend",()=>{t.classList.remove("flash-once")},{once:!0})}async function I(t){const e=await fetch(P(t.typeName));if(!e.ok)return;const c=((await e.json()).pokemon??[]).map(l=>l.pokemon).filter(l=>l?.name&&l.name!==t.name);L(c);const r=c.slice(0,3),a=await Promise.all(r.map(l=>fetch(l.url).then(d=>d.json()).catch(()=>null))),f=o("#same-grid");f.innerHTML="",a.filter(Boolean).forEach(l=>{const d=document.createElement("img");d.src=l.sprites?.front_default??"",d.alt=l.name,f.appendChild(d)}),f.children.length>0&&(o("#same-type").hidden=!1)}function L(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}}o("#btn-start").addEventListener("click",k);o("#btn-battle").addEventListener("click",S);k();
